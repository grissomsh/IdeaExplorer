On System Diagnostics and Reporting for CTD products
This proposal will improve troubleshooting of CTD products and reduce DU duration. It improves support-ability of CTD products.
In VPLEX, we have implemented On System Diagnostics tool which analyze the GeoSynchrony software components for their internal object states and based on pre-defined rule-sets determine if there are issues in the product and what are the impacted virtual-volumes & hosts.

Looking at the CTD idea, I thought it would be good to scale this idea to all CTD products. Applying this On System diagnostics capability and integrating report analysis with other CTD products will fasten the DU resolution time to a great extent.


Each product will have On System Diagnostics capability built in them. The On System Diagnostics will analyse any issues in the product and generate a report on the issues seen in the product. Each product can implements its own ways of diagnostics based on event processing and/or based on querying software components for their internal object states. The diagnostic capability can be built with predefined rule-set based on known issues in the product or as a generic diagnosis. The On System diagnostics will generate a report indicating the issues found in the product. 

A Central Diagnostics and Reporting service/software (CDRS) runs on a dedicated system. This service/software can be hosted from any X86 system. It can also be part of ViPR. It can also be hosted internally in EMC and integrated with SYR to pull product information to login to them. This service/software will connect to each of the CTD product and invoke the On System diagnostics on the product. Once itâ€™s completed, the CDRS will retrieve the report generated by On System diagnostics by the product, analyse it to determine if the issue is in the product. If the report indicate the issue is seen to the other product connected to it, CDRS will connect to next product in the stack and will invoke On System diagnostics of that product and collect the report and analyse it. This goes on unless the product that is having issues is detected. The CDRS will accumulate all the products On System diagnostics report and provide a summarized report on which product is having the issue. The products can also provide the recommendations on how to resolve the issue. The CDRS can query the configuration of these products to intelligently analyse the On System diagnostics report to see if the issue is due to the underlying system that is connected and can invoke On System diagnostics on the underlying system.

For example, in a data centre where there are host clusters connected to storage systems like VPLEX, VNX, VMAX and replication system like RecoverPoint, when the host cluster encounters a DU on a volume which is provisioned by VPLEX, the CDRS will invoke On System Diagnostics of VPLEX. If there are issues found in VPLEX, the On System diagnostics report will indicate that the issue is in VPLEX. If the report indicate issue is on other product connected to VPLEX, the CDRS will invoke On System diagnostics on the product connected with VPLEX (like VNX or VMAX or XIO storage arrays or with RecoverPoint), get the report and analyse the report and generate report indicating the issue identified by the product and also the recommendations provided by the product.

On System diagnostics will reduce the need for collecting logs from each of the product for Customer Support or product specific Engineering teams to RCA the issue. Since the diagnosis and reporting is done on the system, Customer Support teams can act quickly in looking at the summarized report from CDRS and any resolution recommended along with it and resolve the issue.

Link: https://inside.emc.com/docs/DOC-155544

In VPLEX, we have implemented On System Diagnostics tool which queries the GeoSynchrony software components for their internal object states. It has predefined rule-sets defining which states of an internal object indicate which problem. When the tool is run, it will analyse GeoSynchrony software components to see if any of the components have issues. If yes, it will collect them and generate the report indicating the issue and the component. If the issue is on a LUN which is exposed to host, the report will clearly indicate the LUN having the issue. 

Earlier, the system analysis and stuck IO analysis in VPLEX was a manual effort and used to take 6 ~ 8 hours. With the On System diagnostics tool in VPLEX, this has been reduced to 30 minutes. Applying this On System diagnostics capability and integrating report analysis with other CTD products will fasten the DU resolution time to a great extent.
